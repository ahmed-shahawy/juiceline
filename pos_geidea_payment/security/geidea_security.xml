<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Security Groups -->
    <record id="group_geidea_user" model="res.groups">
        <field name="name">Geidea Payment User</field>
        <field name="category_id" ref="base.module_category_point_of_sale"/>
        <field name="implied_ids" eval="[(4, ref('point_of_sale.group_pos_user'))]"/>
    </record>
    
    <record id="group_geidea_manager" model="res.groups">
        <field name="name">Geidea Payment Manager</field>
        <field name="category_id" ref="base.module_category_point_of_sale"/>
        <field name="implied_ids" eval="[(4, ref('group_geidea_user')), (4, ref('point_of_sale.group_pos_manager'))]"/>
    </record>
    
    <!-- Record Rules -->
    
    <!-- Terminal Access Rules -->
    <record id="rule_geidea_terminal_user" model="ir.rule">
        <field name="name">Geidea Terminal: User Access</field>
        <field name="model_id" ref="model_geidea_terminal"/>
        <field name="domain_force">[('state', '=', 'active')]</field>
        <field name="groups" eval="[(4, ref('point_of_sale.group_pos_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>
    
    <record id="rule_geidea_terminal_manager" model="ir.rule">
        <field name="name">Geidea Terminal: Manager Access</field>
        <field name="model_id" ref="model_geidea_terminal"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('point_of_sale.group_pos_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>
    
    <!-- Device Access Rules -->
    <record id="rule_geidea_device_user" model="ir.rule">
        <field name="name">Geidea Device: User Access</field>
        <field name="model_id" ref="model_geidea_device"/>
        <field name="domain_force">[('is_active', '=', True)]</field>
        <field name="groups" eval="[(4, ref('point_of_sale.group_pos_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>
    
    <record id="rule_geidea_device_manager" model="ir.rule">
        <field name="name">Geidea Device: Manager Access</field>
        <field name="model_id" ref="model_geidea_device"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('point_of_sale.group_pos_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>
    
    <!-- Transaction Access Rules -->
    <record id="rule_geidea_transaction_user" model="ir.rule">
        <field name="name">Geidea Transaction: User Access</field>
        <field name="model_id" ref="model_geidea_transaction"/>
        <field name="domain_force">['|', ('pos_session_id.user_id', '=', user.id), ('pos_session_id', '=', False)]</field>
        <field name="groups" eval="[(4, ref('point_of_sale.group_pos_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="False"/>
    </record>
    
    <record id="rule_geidea_transaction_manager" model="ir.rule">
        <field name="name">Geidea Transaction: Manager Access</field>
        <field name="model_id" ref="model_geidea_transaction"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('point_of_sale.group_pos_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>
    
    <!-- Payment Acquirer Access Rules -->
    <record id="rule_payment_acquirer_geidea_user" model="ir.rule">
        <field name="name">Geidea Acquirer: User Access</field>
        <field name="model_id" ref="model_payment_acquirer_geidea"/>
        <field name="domain_force">[('state', '=', 'active')]</field>
        <field name="groups" eval="[(4, ref('point_of_sale.group_pos_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>
    
    <record id="rule_payment_acquirer_geidea_manager" model="ir.rule">
        <field name="name">Geidea Acquirer: Manager Access</field>
        <field name="model_id" ref="model_payment_acquirer_geidea"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('point_of_sale.group_pos_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>
    
    <!-- Multi-company rules -->
    <record id="rule_geidea_terminal_company" model="ir.rule">
        <field name="name">Geidea Terminal: Multi-company</field>
        <field name="model_id" ref="model_geidea_terminal"/>
        <field name="global" eval="True"/>
        <field name="domain_force">['|', ('company_id', '=', False), ('company_id', 'in', company_ids)]</field>
    </record>
    
    <record id="rule_payment_acquirer_geidea_company" model="ir.rule">
        <field name="name">Geidea Acquirer: Multi-company</field>
        <field name="model_id" ref="model_payment_acquirer_geidea"/>
        <field name="global" eval="True"/>
        <field name="domain_force">['|', ('company_id', '=', False), ('company_id', 'in', company_ids)]</field>
    </record>
</odoo>